#### 我的上篇文章讲到我们在[浏览器中输入url之后浏览器干了什么](%5Bhttps://blog.csdn.net/MierCurry/article/details/104532604%5D)，然后其中有什么相关的知识点，这里我会从上到下把这些知识点给大家梳理。这次给大家讲的是HTTPS原理

> 众所周知，大家都知道HTTP协议，那么HTTPS是什么呢？其实HTTPS就是HTTP over TLS，其实TLS之前的版本是叫SSL，这里因为SSL的版本早期已经不被各大浏览器产商支持，所以被废弃掉了。那么何为HTTP over TLS呢？其实HTTPS就是在加密信道上的HTTP请求的传输。

**在给大家讲HTTPS原理之前我给大家科普一个知识**

 - **共享密钥加密**：共享密钥加密就是在HTTPS原理中人们常说到的对称加密，那么什么是共享密钥加密呢？其实就是两个所用的密钥是同一个。但是其实在共享密钥加密会有一个密钥传递的不安全，因为很可能会被第三方给替换掉，所以就有了一种公开密钥加密。
 
 - **公开密钥加密**：公开密钥加密就是HTTPS中人们常说到的非对称加密。那么什么是公开密钥加密呢？公开密钥加密会有两个密钥，一个是主密钥也称做私有密钥，这个一般是不能发送给别人的，一个是公共密钥，这个可以给任何人。其原理就是发送方使用接收方给的公共密钥来加密数据，发送给接收方，然后接收方用私钥来解密。这样数据的安全性就高了很多。但这样也不是说一定安全，只是第三方在不知道私钥的时候去解密其实就是对离散对数的求值，难度很大，目前的技术很难实现。

> 很多文章会说HTTPS会比HTTP安全是因为他们用的非对称加密，所以安全，这样说其实不是一个正确的回答，其实在HTTPS中非对称加密只是用在交换密钥确认两端的身份的时候，而真正的数据还是用的对称加密。那个为什么呢？不是非对称加密更安全吗？其实非对称加密是安全，但是他传输速度比对称加密慢，而我们一般传数据次数很多很大，所以还是用的对称加密。

**那么HTTPS的原理是什么呢？下面来给大家讲一下（我会用我自己的理解把一些不太容易被理解的专业术语说给大家听）：**

 1. 首先客户端会先发送一个Client Hello报文给客户端，同时报文中会包含客户端的**TLS版本**，和**加密列表**（主要包含加密算法、密钥长度、压缩算法）
 
 2. 服务端在接收到客户端发来的报文后，会从中刷选出一个加密列表，这个加密列表是从客户端发送过来的中间筛选出的两端都可识别的，以及一个CA认证的**证书**，其中包含公开密钥加密的公钥、证书的域名范围等信息发送给客户端
 
 3. 客户端在接收到这些数据后，会首先对证书进行验证，对证书的验证之后我们在HTTPS安全中再讲， 在验证证书可用之后，我们会在客户端生成一个随机数，然后用证书中的公钥来加密这个随机数，把这个加密后的数据返回给服务端，同时在客户端会用这个随机数生成一个之后用来数据传递的共享密钥
 
 4. 客户端会再发给服务端一个报文，告诉服务端之后的数据用刚生成的随机数算出的公共密钥来传递
 
 5. 服务端在接收到客户端数据后，会用自己的公共密钥的私有密钥对加密的数据解密，得到随机数，然后服务端一样用这个随机数生成一个共享密钥
 
 6. 客户端会再发送一个Finished报文，这个报文是之前所有报文的整体校验值 
 
 7. 服务端会对报文判断，然后会用生成的共享密钥返回一个Finished报文
 
 8. 客户端接收到Finished报文后，TLS连接就完成了就用共享密钥传递数据   
